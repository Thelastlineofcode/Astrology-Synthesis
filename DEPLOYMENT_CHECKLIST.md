# ðŸš€ Production Deployment Checklist

Complete checklist for deploying Mula: The Root to production.

---

## Pre-Deployment

### Code Quality

- [x] Frontend build passes (`npm run build`)
- [ ] Backend tests pass (if available)
- [ ] All TypeScript errors resolved
- [ ] ESLint warnings reviewed
- [ ] No console.log statements in production code
- [ ] Environment variables configured

### Security

- [ ] JWT secrets generated (min 32 chars)
- [ ] API keys secured in environment variables
- [ ] CORS configured for production domains
- [ ] HTTPS enforced
- [ ] Security headers configured
- [ ] Rate limiting configured (optional)

### Database

- [ ] Database schema finalized
- [ ] Migration scripts ready
- [ ] Seed data prepared (if needed)
- [ ] Backup strategy in place

---

## Vercel Frontend Deployment

### Setup

- [ ] Vercel account created
- [ ] GitHub repository connected
- [ ] Project imported to Vercel
- [ ] Root directory set to `frontend`

### Configuration

- [ ] Build command: `npm run build`
- [ ] Output directory: `.next`
- [ ] Node version: 18.x or higher
- [ ] Framework preset: Next.js

### Environment Variables

- [ ] `NEXT_PUBLIC_API_URL` set to Railway backend URL
- [ ] `NODE_ENV=production`
- [ ] `NEXT_PUBLIC_SENTRY_DSN` (optional)
- [ ] Custom domain configured (optional)

### Verification

- [ ] Deployment successful
- [ ] Homepage loads without errors
- [ ] Navigation works
- [ ] Assets load correctly
- [ ] Mobile responsive
- [ ] Lighthouse score > 80

**Live URL**: `https://astrology-synthesis.vercel.app` or `https://your-custom-domain.com`

ðŸ“– **Guide**: [VERCEL_DEPLOYMENT.md](./VERCEL_DEPLOYMENT.md)

---

## Railway Backend Deployment

### Setup

- [ ] Railway account created
- [ ] GitHub repository connected
- [ ] Project created in Railway
- [ ] PostgreSQL database added

### Configuration

- [ ] Dockerfile verified
- [ ] `railway.toml` configured
- [ ] Start command: `./start.sh` or `uvicorn main:app --host 0.0.0.0 --port $PORT`
- [ ] Health check path: `/health`

### Environment Variables

- [ ] `DATABASE_URL` (auto-generated by Railway)
- [ ] `JWT_SECRET` (generate with: `python3 -c "import secrets; print(secrets.token_urlsafe(32))"`)
- [ ] `JWT_ALGORITHM=HS256`
- [ ] `JWT_EXPIRATION=3600`
- [ ] `ENVIRONMENT=production`
- [ ] `DEBUG=false`
- [ ] `CORS_ORIGINS=["https://astrology-synthesis.vercel.app"]`
- [ ] `PERPLEXITY_API_KEY` (if using AI features)
- [ ] `SENTRY_DSN` (optional)

### Database Setup

- [ ] Run migrations: `railway run alembic upgrade head`
- [ ] Or initialize: `railway connect postgres` â†’ `\i database/init.sql`
- [ ] Verify tables created
- [ ] Create indexes for performance

### Verification

- [ ] Deployment successful
- [ ] Health endpoint returns 200: `curl https://your-backend.railway.app/health`
- [ ] API docs accessible: `https://your-backend.railway.app/docs`
- [ ] Database connection working
- [ ] CORS headers allow frontend origin

**API URL**: `https://your-backend.up.railway.app`

ðŸ“– **Guide**: [RAILWAY_DEPLOYMENT.md](./RAILWAY_DEPLOYMENT.md)

---

## Update Frontend with Backend URL

After Railway deployment:

1. **Copy Backend URL** from Railway Dashboard
2. **Update Vercel Environment Variable**:
   - Go to Vercel Dashboard â†’ Settings â†’ Environment Variables
   - Update `NEXT_PUBLIC_API_URL` to `https://your-backend.up.railway.app`
3. **Redeploy Frontend**: Vercel will auto-deploy on next git push, or manually trigger

---

## Monitoring & Error Tracking

### Sentry Setup

- [ ] Sentry account created
- [ ] Frontend project created
- [ ] Backend project created
- [ ] DSNs copied to environment variables
- [ ] Sentry packages installed:
  - Frontend: `npm install @sentry/nextjs`
  - Backend: `pip install sentry-sdk`
- [ ] Sentry initialized in code
- [ ] Test error captured and visible in dashboard

### Vercel Analytics

- [ ] Analytics enabled in Vercel Dashboard
- [ ] `@vercel/analytics` package installed
- [ ] Analytics component added to layout
- [ ] Speed Insights enabled (optional)

### Uptime Monitoring

- [ ] Uptime Robot or Better Uptime account created
- [ ] Frontend monitor added: `https://astrology-synthesis.vercel.app`
- [ ] Backend monitor added: `https://your-backend.railway.app/health`
- [ ] Alert email configured
- [ ] Status page created (optional)

### Slack Integration (Optional)

- [ ] Slack workspace created
- [ ] Channels created: `#alerts`, `#deployments`, `#errors`
- [ ] Sentry integrated with Slack
- [ ] Vercel integrated with Slack
- [ ] Railway integrated with Slack

ðŸ“– **Guide**: [MONITORING_SETUP.md](./MONITORING_SETUP.md)

---

## Post-Deployment Testing

### Critical User Flows

- [ ] Homepage loads
- [ ] User registration works
- [ ] User login works
- [ ] Fortune reading generated
- [ ] Advisor chat works
- [ ] Profile page loads
- [ ] Reading history accessible
- [ ] Logout works

### API Testing

```bash
# Health check
curl https://your-backend.railway.app/health

# API docs
open https://your-backend.railway.app/docs

# Test CORS
curl -H "Origin: https://astrology-synthesis.vercel.app" \
     -H "Access-Control-Request-Method: POST" \
     -X OPTIONS \
     https://your-backend.railway.app/api/v1/auth/login
```

### Performance Testing

- [ ] Lighthouse score > 80 (Performance)
- [ ] Lighthouse score > 90 (Accessibility)
- [ ] API response time < 500ms (P95)
- [ ] Database queries < 100ms

### Security Testing

- [ ] HTTPS enforced
- [ ] Security headers present
- [ ] XSS protection enabled
- [ ] CSRF protection working
- [ ] JWT tokens expire correctly
- [ ] Sensitive data not exposed in logs/errors

---

## Documentation

### Update README

- [ ] Production URLs added
- [ ] Deployment badges added (optional)
- [ ] Architecture diagram updated
- [ ] API documentation link added

### Team Onboarding

- [ ] Deployment guides reviewed
- [ ] Access credentials shared (securely)
- [ ] Monitoring dashboards shared
- [ ] Runbook created for common issues

---

## CI/CD Pipeline (Optional)

### GitHub Actions

- [ ] `.github/workflows/deploy.yml` created
- [ ] Auto-deploy on push to `master`
- [ ] Run tests before deploy
- [ ] Notify on deployment success/failure

### Quality Gates

- [ ] Require passing tests
- [ ] Require Lighthouse score > 80
- [ ] Require zero critical vulnerabilities
- [ ] Require code review approval

---

## Rollback Plan

### If Deployment Fails

**Vercel**:

1. Go to Vercel Dashboard â†’ Deployments
2. Find last working deployment
3. Click "Promote to Production"

**Railway**:

1. Go to Railway Dashboard â†’ Deployments
2. Find last working deployment
3. Click "Redeploy"

### If Critical Bug Found

1. Revert git commit: `git revert HEAD`
2. Push to trigger auto-deploy: `git push origin master`
3. Or manually roll back in Vercel/Railway dashboards

---

## Success Metrics

### Technical

- âœ… Frontend deployed and accessible
- âœ… Backend deployed and responding
- âœ… Database connected and operational
- âœ… Zero critical errors in Sentry
- âœ… Uptime > 99% (first week)
- âœ… API response time < 500ms (P95)

### Business

- âœ… Users can register and login
- âœ… Users can get fortune readings
- âœ… Users can chat with advisors
- âœ… Data persists correctly
- âœ… Payments work (if applicable)

---

## Post-Launch

### Week 1

- [ ] Monitor error dashboard daily
- [ ] Check uptime status
- [ ] Review user feedback
- [ ] Fix critical bugs immediately
- [ ] Document common issues

### Week 2-4

- [ ] Analyze performance metrics
- [ ] Optimize slow endpoints
- [ ] Improve error handling
- [ ] Add missing features from user feedback
- [ ] Set up automated backups

### Ongoing

- [ ] Weekly performance reviews
- [ ] Monthly security audits
- [ ] Quarterly cost optimization
- [ ] Continuous improvement based on metrics

---

## Support & Resources

### Documentation

- [Vercel Deployment Guide](./VERCEL_DEPLOYMENT.md)
- [Railway Deployment Guide](./RAILWAY_DEPLOYMENT.md)
- [Monitoring Setup Guide](./MONITORING_SETUP.md)
- [API Documentation](./API_DOCUMENTATION.md)
- [Troubleshooting Guide](./TROUBLESHOOTING_GUIDE.md)

### External Resources

- Vercel Docs: https://vercel.com/docs
- Railway Docs: https://docs.railway.app
- Next.js Docs: https://nextjs.org/docs
- FastAPI Docs: https://fastapi.tiangolo.com
- Sentry Docs: https://docs.sentry.io

### Emergency Contacts

- DevOps Lead: [Your Email]
- Backend Lead: [Your Email]
- Frontend Lead: [Your Email]

---

## Sign-Off

**Deployed by**: ******\_\_\_******  
**Date**: ******\_\_\_******  
**Production URL**: ******\_\_\_******  
**API URL**: ******\_\_\_******  
**Sentry Project**: ******\_\_\_******

**All checks passed**: âœ… / âŒ  
**Notes**: **********************\_\_\_**********************

---

**Status**: ðŸš€ Ready for Production Deployment

Once all items are checked, the application is ready to serve users!
